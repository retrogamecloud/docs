---
title: "GET /rankings/game/:gameSlug"
description: "Obtener ranking de un juego espec√≠fico"
api: "GET https://api.retrogamehub.games/rankings/game/:gameSlug"
---

## Descripci√≥n

Obtiene la tabla de clasificaci√≥n (leaderboard) de un juego espec√≠fico, ordenada por puntuaci√≥n m√°s alta.

## Path Parameters

<ParamField path="gameSlug" type="string" required>
  Slug del juego (ej: "doom", "tetris", "duke3d")
</ParamField>

## Query Parameters

<ParamField query="limit" type="number" default="50">
  N√∫mero de jugadores a retornar (1-100)
</ParamField>

<ParamField query="offset" type="number" default="0">
  Offset para paginaci√≥n
</ParamField>

<ParamField query="period" type="string" default="all-time">
  Periodo de tiempo: `all-time`, `monthly`, `weekly`, `daily`
</ParamField>

## Response

<ResponseField name="game" type="object">
  Informaci√≥n del juego
  
  <Expandable title="properties">
    <ResponseField name="id" type="number">
      ID del juego
    </ResponseField>
    
    <ResponseField name="name" type="string">
      Nombre del juego
    </ResponseField>
    
    <ResponseField name="slug" type="string">
      Slug del juego
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="rankings" type="array">
  Array de jugadores ordenados por puntuaci√≥n
  
  <Expandable title="Ranking Object">
    <ResponseField name="rank" type="number">
      Posici√≥n en el ranking
    </ResponseField>
    
    <ResponseField name="user_id" type="number">
      ID del usuario
    </ResponseField>
    
    <ResponseField name="username" type="string">
      Nombre de usuario
    </ResponseField>
    
    <ResponseField name="display_name" type="string">
      Nombre para mostrar
    </ResponseField>
    
    <ResponseField name="score" type="number">
      Puntuaci√≥n en el juego
    </ResponseField>
    
    <ResponseField name="updated_at" type="string">
      Fecha del √∫ltimo highscore (ISO 8601)
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="total_players" type="number">
  Total de jugadores con puntuaciones en este juego
</ResponseField>

<ResponseField name="limit" type="number">
  L√≠mite aplicado
</ResponseField>

<ResponseField name="offset" type="number">
  Offset aplicado
</ResponseField>

<ResponseField name="period" type="string">
  Periodo aplicado
</ResponseField>

<ResponseField name="cached_at" type="string">
  Timestamp del cach√© (ISO 8601)
</ResponseField>

<RequestExample>

```bash cURL - Top 50 de DOOM
curl https://api.retrogamehub.games/rankings/game/doom
```

```bash cURL - Top 10 semanal
curl "https://api.retrogamehub.games/rankings/game/tetris?limit=10&period=weekly"
```

```javascript JavaScript
async function loadGameLeaderboard(gameSlug, period = 'all-time') {
  const response = await fetch(
    `https://api.retrogamehub.games/rankings/game/${gameSlug}?limit=100&period=${period}`
  );
  
  const data = await response.json();
  
  console.log(`Leaderboard de ${data.game.name}`);
  console.log(`Total de jugadores: ${data.total_players}`);
  
  return data.rankings;
}

// Mostrar top 10
const top10 = await loadGameLeaderboard('doom', 'all-time');
top10.slice(0, 10).forEach(player => {
  console.log(`#${player.rank}: ${player.display_name} - ${player.score.toLocaleString()}`);
});
```

```python Python
import requests

game_slug = 'duke3d'
period = 'monthly'

response = requests.get(
    f'https://api.retrogamehub.games/rankings/game/{game_slug}',
    params={
        'limit': 50,
        'period': period
    }
)

data = response.json()

print(f"=== {data['game']['name']} - Top {period.upper()} ===")
for player in data['rankings'][:10]:
    print(f"#{player['rank']}: {player['display_name']} - {player['score']:,}")
```

</RequestExample>

<ResponseExample>

```json 200 - Success
{
  "game": {
    "id": 1,
    "name": "DOOM",
    "slug": "doom"
  },
  "rankings": [
    {
      "rank": 1,
      "user_id": 42,
      "username": "doomguy",
      "display_name": "Doom Guy",
      "score": 250000,
      "updated_at": "2025-11-18T14:22:00.000Z"
    },
    {
      "rank": 2,
      "user_id": 89,
      "username": "slayer",
      "display_name": "Demon Slayer",
      "score": 235400,
      "updated_at": "2025-11-17T09:15:00.000Z"
    },
    {
      "rank": 3,
      "user_id": 156,
      "username": "marine",
      "display_name": "Space Marine",
      "score": 198750,
      "updated_at": "2025-11-19T11:30:00.000Z"
    }
  ],
  "total_players": 1547,
  "limit": 50,
  "offset": 0,
  "period": "all-time",
  "cached_at": "2025-11-19T15:32:00.000Z"
}
```

```json 404 - Game Not Found
{
  "error": "Juego no encontrado: invalid-slug"
}
```

```json 400 - Invalid Period
{
  "error": "Period debe ser: all-time, monthly, weekly o daily"
}
```

</ResponseExample>

## Periodos Disponibles

<Tabs>
  <Tab title="All-Time">
    **Todos los tiempos**
    
    Ranking hist√≥rico con todas las puntuaciones registradas desde el inicio.
    
    - Cach√©: 5 minutos
    - Uso: Leaderboard principal
  </Tab>
  
  <Tab title="Monthly">
    **Mes actual**
    
    Solo puntuaciones del mes en curso (se resetea el d√≠a 1).
    
    - Cach√©: 10 minutos
    - Uso: Competencia mensual
  </Tab>
  
  <Tab title="Weekly">
    **Semana actual**
    
    Solo puntuaciones de los √∫ltimos 7 d√≠as.
    
    - Cach√©: 15 minutos
    - Uso: Desaf√≠os semanales
  </Tab>
  
  <Tab title="Daily">
    **Hoy**
    
    Solo puntuaciones del d√≠a actual.
    
    - Cach√©: 30 minutos
    - Uso: Competencia diaria
  </Tab>
</Tabs>

## Ejemplo de Implementaci√≥n Completa

```javascript
// Game Leaderboard Component con m√∫ltiples periodos

class GameLeaderboard {
  constructor(gameSlug) {
    this.gameSlug = gameSlug;
    this.period = 'all-time';
    this.rankings = [];
    this.currentPage = 0;
    this.pageSize = 50;
  }
  
  async load() {
    const response = await fetch(
      `https://api.retrogamehub.games/rankings/game/${this.gameSlug}?` +
      `limit=${this.pageSize}&` +
      `offset=${this.currentPage * this.pageSize}&` +
      `period=${this.period}`
    );
    
    const data = await response.json();
    
    this.game = data.game;
    this.rankings = data.rankings;
    this.totalPlayers = data.total_players;
    this.cachedAt = new Date(data.cached_at);
    
    this.render();
  }
  
  render() {
    const container = document.getElementById('leaderboard');
    
    container.innerHTML = `
      <div class="leaderboard-header">
        <h1>üéÆ ${this.game.name}</h1>
        <h2>Tabla de Clasificaci√≥n</h2>
        
        <div class="period-selector">
          ${this.renderPeriodTabs()}
        </div>
        
        <p class="total-players">
          ${this.totalPlayers.toLocaleString()} jugadores
        </p>
        
        <p class="cache-info">
          Actualizado: ${this.cachedAt.toLocaleString()}
        </p>
      </div>
      
      <div class="leaderboard-content">
        ${this.renderTopThree()}
        ${this.renderTable()}
      </div>
      
      <div class="pagination">
        ${this.renderPagination()}
      </div>
      
      <div class="my-position">
        ${this.renderMyPosition()}
      </div>
    `;
  }
  
  renderPeriodTabs() {
    const periods = [
      { value: 'all-time', label: 'Todo' },
      { value: 'monthly', label: 'Mes' },
      { value: 'weekly', label: 'Semana' },
      { value: 'daily', label: 'Hoy' }
    ];
    
    return periods.map(p => `
      <button 
        class="period-tab ${this.period === p.value ? 'active' : ''}"
        onclick="leaderboard.changePeriod('${p.value}')"
      >
        ${p.label}
      </button>
    `).join('');
  }
  
  renderTopThree() {
    const top3 = this.rankings.slice(0, 3);
    
    if (top3.length === 0) return '';
    
    return `
      <div class="podium">
        ${top3[1] ? this.renderPodiumPlayer(top3[1], 2, 'ü•à') : ''}
        ${top3[0] ? this.renderPodiumPlayer(top3[0], 1, 'ü•á') : ''}
        ${top3[2] ? this.renderPodiumPlayer(top3[2], 3, 'ü•â') : ''}
      </div>
    `;
  }
  
  renderPodiumPlayer(player, rank, medal) {
    const height = rank === 1 ? 'tall' : rank === 2 ? 'medium' : 'short';
    
    return `
      <div class="podium-player ${height}">
        <div class="medal">${medal}</div>
        <div class="player-name">${player.display_name}</div>
        <div class="player-score">${player.score.toLocaleString()}</div>
      </div>
    `;
  }
  
  renderTable() {
    const remainingPlayers = this.rankings.slice(3);
    
    return `
      <table class="leaderboard-table">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Jugador</th>
            <th>Puntuaci√≥n</th>
            <th>Fecha</th>
          </tr>
        </thead>
        <tbody>
          ${remainingPlayers.map(player => `
            <tr>
              <td class="rank">#${player.rank}</td>
              <td class="player">
                <a href="/profile/${player.user_id}">
                  ${player.display_name}
                </a>
              </td>
              <td class="score">${player.score.toLocaleString()}</td>
              <td class="date">
                ${new Date(player.updated_at).toLocaleDateString()}
              </td>
            </tr>
          `).join('')}
        </tbody>
      </table>
    `;
  }
  
  renderMyPosition() {
    const userId = this.getCurrentUserId();
    if (!userId) return '';
    
    const myRank = this.rankings.find(p => p.user_id === userId);
    
    if (myRank) {
      return `
        <div class="my-rank highlight">
          <strong>Tu posici√≥n:</strong> #${myRank.rank}
          <span class="my-score">${myRank.score.toLocaleString()} puntos</span>
        </div>
      `;
    } else {
      return `
        <div class="my-rank">
          <p>A√∫n no tienes puntuaci√≥n en este juego</p>
          <button onclick="playGame('${this.gameSlug}')">
            ¬°Jugar Ahora!
          </button>
        </div>
      `;
    }
  }
  
  renderPagination() {
    const totalPages = Math.ceil(this.totalPlayers / this.pageSize);
    
    return `
      <button 
        onclick="leaderboard.previousPage()" 
        ${this.currentPage === 0 ? 'disabled' : ''}
      >
        ‚Üê Anterior
      </button>
      
      <span class="page-info">
        P√°gina ${this.currentPage + 1} de ${totalPages}
      </span>
      
      <button 
        onclick="leaderboard.nextPage()"
        ${this.currentPage >= totalPages - 1 ? 'disabled' : ''}
      >
        Siguiente ‚Üí
      </button>
    `;
  }
  
  async changePeriod(period) {
    this.period = period;
    this.currentPage = 0;
    await this.load();
  }
  
  async nextPage() {
    this.currentPage++;
    await this.load();
    window.scrollTo(0, 0);
  }
  
  async previousPage() {
    this.currentPage = Math.max(0, this.currentPage - 1);
    await this.load();
    window.scrollTo(0, 0);
  }
  
  getCurrentUserId() {
    // Obtener del localStorage o token JWT
    const token = localStorage.getItem('token');
    if (!token) return null;
    
    const payload = JSON.parse(atob(token.split('.')[1]));
    return payload.userId;
  }
  
  // Auto-refresh cada 2 minutos
  startAutoRefresh() {
    setInterval(() => this.load(), 2 * 60 * 1000);
  }
}

// Uso
const gameSlug = new URLSearchParams(window.location.search).get('game');
const leaderboard = new GameLeaderboard(gameSlug);
leaderboard.load();
leaderboard.startAutoRefresh();
```

## Caching y Performance

<Info>
  Los rankings se cachean en **Redis con diferentes TTL** seg√∫n el periodo:
  
  - All-time: 5 minutos
  - Monthly: 10 minutos
  - Weekly: 15 minutos
  - Daily: 30 minutos
</Info>

## Invalidaci√≥n de Cach√©

Cuando un jugador env√≠a una nueva puntuaci√≥n, el sistema:

1. Guarda el score en PostgreSQL
2. Publica evento a Redis Pub/Sub
3. Ranking Service escucha el evento
4. Invalida cach√© del juego afectado
5. Pr√≥xima petici√≥n regenera el ranking

```javascript
// Ejemplo de invalidaci√≥n (backend)
async function onScoreSubmitted(gameSlug) {
  // Invalidar todos los periodos del juego
  await redis.del(`ranking:${gameSlug}:all-time`);
  await redis.del(`ranking:${gameSlug}:monthly`);
  await redis.del(`ranking:${gameSlug}:weekly`);
  await redis.del(`ranking:${gameSlug}:daily`);
  
  console.log(`Cache invalidado para ${gameSlug}`);
}
```

## Rate Limiting

- **L√≠mite**: 100 peticiones por minuto por IP
- **Recomendaci√≥n**: Cachea en el frontend y refresca cada 2-5 minutos

## Competencias y Eventos

```javascript
// Mostrar competencia del mes actual

async function showMonthlyCompetition(gameSlug) {
  const response = await fetch(
    `https://api.retrogamehub.games/rankings/game/${gameSlug}?period=monthly&limit=10`
  );
  
  const data = await response.json();
  
  const daysLeft = getDaysLeftInMonth();
  
  console.log(`üèÜ Competencia de ${data.game.name} - ${daysLeft} d√≠as restantes`);
  console.log('Top 10 del mes:');
  
  data.rankings.forEach(player => {
    console.log(`#${player.rank}: ${player.display_name} - ${player.score.toLocaleString()}`);
  });
}

function getDaysLeftInMonth() {
  const now = new Date();
  const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);
  return lastDay.getDate() - now.getDate();
}
```
