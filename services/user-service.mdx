---
title: 3.2. Servicio de Usuarios
description: Gestión de perfiles y datos de usuarios
icon: user
---

## Descripción

El servicio de usuarios gestiona los perfiles, preferencias y estadísticas de los jugadores en la plataforma. Proporciona funcionalidades completas para la administración de cuentas de usuario, incluyendo autenticación, personalización y seguimiento de actividad.

<CardGroup cols={3}>
  <Card title="Perfiles" icon="id-card">
    Información completa de usuario

    Username, email, avatar, bio y configuración personal
  </Card>

  <Card title="Estadísticas" icon="chart-simple">
    Historial y métricas de juego

    Scores totales, juegos jugados, rankings y progreso
  </Card>

  <Card title="Preferencias" icon="sliders">
    Configuración personalizada

    Tema, idioma, privacidad y notificaciones
  </Card>
</CardGroup>

## Información Técnica

| Aspecto | Detalle |
|---------|---------|
| **Puerto** | 3002 |
| **Base de Datos** | PostgreSQL (usuarios, perfiles, estadísticas) |
| **Dependencias** | Auth Service, Game Service |
| **Cache** | Redis (sesiones, datos frecuentes) |

## Características Principales

### Gestión de Perfiles

- Creación y actualización de perfiles de usuario

- Subida y gestión de avatares personalizados

- Biografías y información personal

- Sistema de verificación de cuentas

### Sistema de Estadísticas

- Tracking automático de actividad de juego

- Cálculo de rankings globales y por juego

- Historial detallado de scores y logros

- Métricas de tiempo de juego

### Configuración y Preferencias

- Personalización de interfaz (tema, idioma)

- Configuración de privacidad granular

- Gestión de notificaciones

- Preferencias de juego

## Endpoints Principales

### Gestión de Perfiles

<Card title="GET /api/users/:username" icon="eye" href="/api-reference/user-service/get-user-profile">
  Obtener perfil público de usuario
</Card>

<Card title="PUT /api/users/:username" icon="pen" href="/api-reference/user-service/update-user-profile">
  Actualizar perfil de usuario
</Card>

<Card title="POST /api/users/avatar" icon="image" href="/api-reference/user-service/upload-avatar">
  Subir avatar de usuario
</Card>

### Estadísticas y Rankings

<Card title="GET /api/users/:username/stats" icon="chart-line" href="/api-reference/user-service/get-user-stats">
  Obtener estadísticas de usuario
</Card>

<Card title="GET /api/rankings/:gameType" icon="trophy" href="/api-reference/user-service/get-rankings">
  Obtener rankings por tipo de juego
</Card>

### Configuración

<Card title="GET/PUT /api/users/:username/preferences" icon="cog" href="/api-reference/user-service/user-preferences">
  Gestionar preferencias de usuario
</Card>

## Problemas Comunes

### Error: Usuario no encontrado (404)

* *Síntomas:**

- Error al obtener perfil de usuario

- Usuario inexistente en base de datos

* *Logs relevantes:**

```bash
[ERROR] User not found: username 'player123' does not exist in database
[WARN] Attempted access to non-existent user profile

```

* *Soluciones rápidas:**
1. Verificar que el username sea correcto
2. Comprobar que la cuenta no haya sido eliminada
3. Revisar sincronización con Auth Service

### Error: Fallo en subida de avatar

* *Síntomas:**

- Avatar no se actualiza

- Error 413 (archivo muy grande)

- Error de formato de imagen

* *Logs relevantes:**

```bash
[ERROR] Avatar upload failed: File size exceeds 5MB limit
[ERROR] Invalid image format: only JPG, PNG, GIF allowed
[WARN] S3 bucket connection timeout

```

* *Soluciones rápidas:**
1. Verificar tamaño del archivo (máximo 5MB)
2. Confirmar formato válido (JPG, PNG, GIF)
3. Revisar conexión con almacenamiento S3
4. Limpiar cache de avatares: `redis-cli DEL avatar:*`

### Error: Estadísticas desactualizadas

* *Síntomas:**

- Rankings no reflejan juegos recientes

- Estadísticas congeladas

- Diferencias entre servicios

* *Logs relevantes:**

```bash
[ERROR] Stats sync failed: Game Service unreachable
[WARN] Ranking calculation timeout after 30s
[INFO] Stats cache invalidated for user: player123

```

* *Soluciones rápidas:**
1. Verificar conexión con Game Service
2. Forzar recálculo de estadísticas:
   ```bash
   curl -X POST http://localhost:3002/api/admin/recalculate-stats
   ```

3. Limpiar cache de rankings: `redis-cli FLUSHDB 2`
4. Revisar job de sincronización en cola de tareas

### Error: Preferencias no se guardan

* *Síntomas:**

- Configuración se resetea al recargar

- Error 422 en validación

- Preferencias no persisten

* *Logs relevantes:**

```bash
[ERROR] Invalid preference value: theme must be 'light', 'dark', or 'auto'
[WARN] Database constraint violation on preferences update
[ERROR] Redis session store unavailable

```

* *Soluciones rápidas:**
1. Validar formato de preferencias según esquema
2. Verificar conexión a base de datos PostgreSQL
3. Revisar disponibilidad de Redis para sesiones
4. Comprobar permisos de escritura del usuario

### Performance: Consultas lentas en rankings

* *Síntomas:**

- Timeout en carga de rankings

- Alto uso de CPU/memoria

- Respuestas lentas en endpoints de estadísticas

* *Logs relevantes:**

```bash
[WARN] Slow query detected: ranking calculation took 15.2s
[INFO] Database connection pool exhausted
[ERROR] Query timeout: rankings for game_type 'puzzle'

```

* *Soluciones rápidas:**
1. Verificar índices en tablas de estadísticas
2. Aumentar pool de conexiones PostgreSQL
3. Activar cache de rankings:
   ```bash
   redis-cli SET "ranking:puzzle:cache" "enabled" EX 3600
   ```

4. Considerar paginación en rankings grandes