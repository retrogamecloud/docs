---
title: 8.4. Soluci√≥n de Problemas Comunes
description: Gu√≠a completa de resoluci√≥n de problemas en Retro Game Hub para desarrollo
  y producci√≥n
icon: file-lines
---

# üîß Troubleshooting

Gu√≠a completa para diagnosticar y resolver problemas comunes en Retro Game Hub en entornos de desarrollo y producci√≥n.

- --

## üè† Entorno de Desarrollo

### üéÆ Problemas de Juegos

#### 1. Juego No Carga

* *S√≠ntomas:**

- Pantalla negra despu√©s de seleccionar juego

- Mensaje "Error loading game"

- Barra de progreso se queda congelada

* *Diagn√≥stico:**

```bash

# 1. Verificar que el archivo .jsdos existe localmente
ls -la public/juegos/

# 2. Verificar permisos de archivos
chmod 644 public/juegos/*.jsdos

# 3. Verificar servidor de desarrollo
curl -I http://localhost:3000/juegos/doom.jsdos

# 4. Verificar consola del navegador

# F12 > Console > buscar errores de CORS o 404

```

* *Soluciones:**

- **A. Archivo no encontrado (404)**
  ```bash
  # Verificar que el archivo existe
  cp ~/Downloads/doom.jsdos public/juegos/
  ```

- **B. Problema de CORS en desarrollo**
  ```javascript
  // next.config.js
  module.exports = {
    async headers() {
      return [
        {
          source: '/juegos/:path*',
          headers: [
            { key: 'Access-Control-Allow-Origin', value: '*' },
            { key: 'Access-Control-Allow-Methods', value: 'GET' }
          ]
        }
      ]
    }
  }
  ```

- **C. js-dos no inicializa**
  ```javascript
  // Verificar en consola del navegador
  console.log(typeof Dos); // Debe ser 'function'

  // Si es undefined, verificar que js-dos.js est√° cargado
  <script src="/jsdos/js-dos.js"></script>
  ```

#### 2. Problemas de Performance

* *S√≠ntomas:**

- Juego se ejecuta muy lento

- Audio entrecortado

- Controles con retraso

* *Soluciones:**

```javascript
// Ajustar configuraci√≥n de js-dos
const dosOptions = {
  wdosboxUrl: "/jsdos/wdosbox.wasm",
  cycles: "auto",      // Reducir si hay problemas
  autolock: false,     // Desactivar para debugging
  aspectRatio: "keep"
};

```

### üîê Problemas de Autenticaci√≥n

#### Error de Login

* *S√≠ntomas:**

- Login falla con credenciales correctas

- Error "Invalid credentials"

- Redirecci√≥n incorrecta despu√©s del login

* *Diagn√≥stico:**

```bash

# Verificar variables de entorno
echo $NEXTAUTH_URL
echo $NEXTAUTH_SECRET

# Verificar base de datos
npx prisma studio

# Verificar logs de NextAuth
DEBUG=nextauth* npm run dev

```

* *Soluciones:**

```bash

# 1. Configurar variables de entorno
cat > .env.local <<EOF
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=$(openssl rand -base64 32)
DATABASE_URL="postgresql://user:pass@localhost:5432/retrogame"
EOF

# 2. Reinicializar base de datos
npx prisma migrate reset
npx prisma generate
npx prisma db push

```

### üóÑÔ∏è Problemas de Base de Datos

#### Conexi√≥n Fallida

* *Diagn√≥stico:**

```bash

# Verificar que PostgreSQL est√° corriendo
pg_isready -h localhost -p 5432

# Probar conexi√≥n directa
psql postgresql://user:pass@localhost:5432/retrogame

# Verificar logs de Prisma
npx prisma db pull --preview-feature

```

* *Soluciones:**

```bash

# Iniciar PostgreSQL (macOS)
brew services start postgresql

# Iniciar PostgreSQL (Linux)
sudo systemctl start postgresql

# Crear base de datos si no existe
createdb retrogame

# Aplicar migraciones
npx prisma migrate deploy

```

### üì¶ Problemas de Dependencias

#### Error de Instalaci√≥n

* *Diagn√≥stico:**

```bash

# Limpiar cache
rm -rf node_modules package-lock.json
npm cache clean --force

# Verificar versiones
node --version  # Requiere Node 18+
npm --version

# Instalar con logs verbosos
npm install --verbose

```

* *Soluciones:**

```bash

# Usar versi√≥n correcta de Node
nvm use 18
nvm install 18

# Instalar dependencias
npm ci

# Si persisten errores, usar yarn
yarn install

```

- --

## üöÄ Entorno de Producci√≥n

### üåê Problemas de CDN y Assets

#### 1. Juego No Carga en Producci√≥n

* *S√≠ntomas:**

- Funciona en desarrollo pero no en producci√≥n

- Error 403/404 al cargar .jsdos

- CORS errors en consola

* *Diagn√≥stico:**

```bash

# 1. Verificar que el archivo existe en S3
aws s3 ls s3://retrogame-cdn-production/juegos/

# 2. Verificar permisos p√∫blicos del bucket
aws s3api get-bucket-policy --bucket retrogame-cdn-production

# 3. Verificar CloudFront
aws cloudfront get-distribution --id E1XXXXXXXXXXXXX

# 4. Probar descarga directa
curl -I https://cdn.retrogamehub.games/juegos/doom.jsdos

# 5. Verificar headers CORS
curl -H "Origin: https://retrogamehub.games" \
     -H "Access-Control-Request-Method: GET" \
     -H "Access-Control-Request-Headers: X-Requested-With" \
     -X OPTIONS \
     https://cdn.retrogamehub.games/juegos/doom.jsdos

```

* *Soluciones:**

- **A. Archivo no encontrado (404)**
  ```bash
  # Subir el archivo faltante
  aws s3 cp doom.jsdos s3://retrogame-cdn-production/juegos/

  # Verificar que se subi√≥ correctamente
  aws s3 ls s3://retrogame-cdn-production/juegos/doom.jsdos

  # Invalidar cach√© de CloudFront
  aws cloudfront create-invalidation \
    --distribution-id E1XXXXXXXXXXXXX \
    --paths "/juegos/doom.jsdos"
  ```

- **B. Problema de CORS**
  ```bash
  # Verificar configuraci√≥n CORS actual
  aws s3api get-bucket-cors --bucket retrogame-cdn-production

  # Aplicar pol√≠tica CORS correcta
  cat > cors.json <<EOF
  {
    "CORSRules": [{
      "AllowedOrigins": [
        "https://retrogamehub.games",
        "https://www.retrogamehub.games"
      ],
      "AllowedMethods": ["GET", "HEAD"],
      "AllowedHeaders": ["*"],
      "MaxAgeSeconds": 3600
    }]
  }
  EOF

  aws s3api put-bucket-cors \
    --bucket retrogame-cdn-production \
    --cors-configuration file://cors.json
  ```

- **C. Permisos de S3**
  ```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "PublicReadGetObject",
        "Effect": "Allow",
        "Principal": "*",
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::retrogame-cdn-production/juegos/*"
      }
    ]
  }
  ```

#### 2. CloudFront Issues

* *S√≠ntomas:**

- Contenido desactualizado

- Errores intermitentes

- Performance lenta

* *Diagn√≥stico:**

```bash

# Verificar estado de distribuci√≥n
aws cloudfront get-distribution --id E1XXXXXXXXXXXXX

# Verificar invalidaciones pendientes
aws cloudfront list-invalidations --distribution-id E1XXXXXXXXXXXXX

# Probar desde diferentes regiones
curl -I -H "CloudFront-Viewer-Country: US" \
  https://cdn.retrogamehub.games/juegos/doom.jsdos

```

* *Soluciones:**

```bash

# Invalidar cach√© completo
aws cloudfront create-invalidation \
  --distribution-id E1XXXXXXXXXXXXX \
  --paths "/*"

# Verificar configuraci√≥n de cach√©
aws cloudfront get-distribution-config \
  --id E1XXXXXXXXXXXXX \
  --query 'DistributionConfig.DefaultCacheBehavior'

```

### üîí Problemas de SSL/TLS

#### Certificado Expirado

* *Diagn√≥stico:**

```bash

# Verificar certificado
openssl s_client -connect retrogamehub.games:443 -servername retrogamehub.games

# Verificar en AWS Certificate Manager
aws acm list-certificates --region us-east-1

# Verificar fecha de expiraci√≥n
curl -vI https://retrogamehub.games 2>&1 | grep -i expire

```

* *Soluciones:**

```bash

# Renovar certificado (si es manual)
aws acm request-certificate \
  --domain-name retrogamehub.games \
  --domain-name www.retrogamehub.games \
  --validation-method DNS

# Actualizar CloudFront con nuevo certificado
aws cloudfront update-distribution \
  --id E1XXXXXXXXXXXXX \
  --distribution-config file://new-cert-config.json

```

### üóÑÔ∏è Problemas de Base de Datos en Producci√≥n

#### Conexi√≥n Lenta/Timeout

* *Diagn√≥stico:**

```bash

# Verificar conexiones activas
SELECT count(*) FROM pg_stat_activity;

# Verificar queries lentas
SELECT query, mean_time, calls
FROM pg_stat_statements
ORDER BY mean_time DESC
LIMIT 10;

# Verificar locks
SELECT * FROM pg_locks WHERE NOT granted;

```

* *Soluciones:**

```sql

- - Optimizar conexiones
ALTER SYSTEM SET max_connections = 100;
ALTER SYSTEM SET shared_buffers = '256MB';

- - Terminar conexiones colgadas
SELECT pg_terminate_backend(pid)
FROM pg_stat_activity
WHERE state = 'idle'
AND state_change < current_timestamp - INTERVAL '1 hour';

```

### üìä Problemas de Performance

#### Carga Lenta

* *Diagn√≥stico:**

```bash

# Verificar m√©tricas de CloudWatch
aws cloudwatch get-metric-statistics \
  --namespace AWS/ApplicationELB \
  --metric-name ResponseTime \
  --start-time 2024-01-01T00:00:00Z \
  --end-time 2024-01-01T23:59:59Z \
  --period 3600 \
  --statistics Average

# Verificar logs de aplicaci√≥n
aws logs filter-log-events \
  --log-group-name /aws/lambda/retrogame-api \
  --filter-pattern "ERROR"

# Analizar bundle size
npm run analyze

```

* *Soluciones:**

```javascript
// Optimizar imports
import dynamic from 'next/dynamic';

const GamePlayer = dynamic(() => import('../components/GamePlayer'), {
  loading: () => <p>Cargando juego...</p>,
  ssr: false
});

// Optimizar im√°genes
import Image from 'next/image';

<Image
  src="/games/doom-cover.jpg"
  alt="Doom"
  width={300}
  height={400}
  priority={false}
  loading="lazy"
/>

```

- --

## üîß Herramientas de Debugging

### Logs y Monitoreo

```bash

# Logs de desarrollo
npm run dev 2>&1 | tee debug.log

# Logs de producci√≥n (Vercel)
vercel logs

# Logs de AWS Lambda
aws logs tail /aws/lambda/retrogame-api --follow

# Monitoreo en tiempo real
npx @next/bundle-analyzer

```

### Scripts de Diagn√≥stico

```bash
#!/bin/bash

# check-health.sh

echo "üîç Verificando salud del sistema..."

# 1. Verificar conectividad
curl -I https://retrogamehub.games || echo "‚ùå Sitio no accesible"

# 2. Verificar CDN
curl -I https://cdn.retrogamehub.games || echo "‚ùå CDN no accesible"

# 3. Verificar API
curl -I https://retrogamehub.games/api/health || echo "‚ùå API no responde"

# 4. Verificar base de datos
psql $DATABASE_URL -c "SELECT 1;" || echo "‚ùå Base de datos no accesible"

echo "‚úÖ Verificaci√≥n completada"

```

- --

## üìû Escalaci√≥n de Problemas

### Niveles de Severidad

* *üî¥ Cr√≠tico (P0)**

- Sitio completamente inaccesible

- P√©rdida de datos

- Vulnerabilidad de seguridad activa

* *üü° Alto (P1)**

- Funcionalidad principal no disponible

- Performance severamente degradada

- Errores que afectan a >50% de usuarios

* *üü¢ Medio (P2)**

- Funcionalidades secundarias afectadas

- Problemas de UX menores

- Errores intermitentes

* *üîµ Bajo (P3)**

- Mejoras cosm√©ticas

- Optimizaciones

- Documentaci√≥n

### Contactos de Emergencia

```yaml

# contacts.yml
production_issues:
  - role: "Lead Developer"
    contact: "dev@retrogamehub.games"
    phone: "+1-xxx-xxx-xxxx"

  - role: "DevOps Engineer"
    contact: "devops@retrogamehub.games"
    phone: "+1-xxx-xxx-xxxx"

infrastructure:
  - service: "AWS Support"
    tier: "Business"
    case_url: "https://console.aws.amazon.com/support/"

  - service: "Vercel Support"
    tier: "Pro"
    contact: "support@vercel.com"

```

- --

## üìù Reporting de Bugs

### Template de Reporte

```markdown

## üêõ Bug Report

* *Descripci√≥n:**
Descripci√≥n clara del problema

* *Pasos para Reproducir:**
1. Ve a '...'
2. Haz clic en '....'
3. Despl√°zate hacia abajo hasta '....'
4. Ver error

* *Comportamiento Esperado:**
Descripci√≥n de lo que esperabas que ocurriera

* *Comportamiento Actual:**
Descripci√≥n de lo que realmente ocurre

* *Capturas de Pantalla:**
Si aplica, adjuntar capturas

* *Informaci√≥n del Sistema:**

- OS: [e.g. macOS 14.0]

- Browser: [e.g. Chrome 120.0]

- Versi√≥n: [e.g. 1.2.0]

* *Informaci√≥n Adicional:**
Cualquier otro contexto sobre el problema

```

### Logs √ötiles

```javascript
// Frontend debugging
console.group('üéÆ Game Loading Debug');
console.log('Game URL:', gameUrl);
console.log('js-dos loaded:', typeof Dos !== 'undefine

```