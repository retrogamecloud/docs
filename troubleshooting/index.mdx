---
title: 6.10. Resolución de Problemas
description: Guía completa para diagnosticar y resolver problemas comunes en RetroGameCloud
icon: wrench
---

# 6.10. Resolución de Problemas

Esta guía proporciona soluciones estructuradas para los problemas más comunes en RetroGameCloud, organizadas por categoría para facilitar el diagnóstico y la resolución.

<Note>
Para cada problema, sigue el proceso: **Síntomas** → **Diagnóstico** → **Solución** → **Prevención**
</Note>

## Navegación Rápida

Selecciona la categoría que mejor describa tu problema:

<CardGroup cols={2}>
  <Card title="Problemas de Kubernetes" icon="dharmachakra" href="/troubleshooting/kubernetes">
    Pods en CrashLoopBackOff, servicios no disponibles, problemas de red y recursos
  </Card>
  
  <Card title="Problemas de Base de Datos" icon="database" href="/troubleshooting/database">
    Conexiones fallidas, consultas lentas, migraciones y backups
  </Card>
  
  <Card title="Problemas de Autenticación" icon="shield-check" href="/troubleshooting/auth">
    JWT tokens, OAuth, permisos y acceso de usuarios
  </Card>
  
  <Card title="Problemas de Performance" icon="gauge-high" href="/troubleshooting/performance">
    Latencia alta, uso excesivo de recursos y optimización
  </Card>
  
  <Card title="Problemas de Storage" icon="hard-drive" href="/troubleshooting/storage">
    Subida de archivos, almacenamiento de ROMs y configuración S3
  </Card>
  
  <Card title="Problemas de Red" icon="network-wired" href="/troubleshooting/network">
    Conectividad, DNS, load balancers y proxies
  </Card>
</CardGroup>

## Problemas Más Comunes

### CrashLoopBackOff en Kubernetes

<Tabs>
<Tab title="Síntomas">

**Indicadores del problema:**

- Pods reiniciándose constantemente
- Estado `CrashLoopBackOff` en `kubectl get pods`
- Logs mostrando errores de arranque
- Aplicación no disponible
</Tab>
<Tab title="Diagnóstico">

```bash
# Ver estado de pods
kubectl get pods -n retrogame

# Revisar logs del contenedor
kubectl logs <pod-name> -n retrogame --previous

# Describir el pod para eventos
kubectl describe pod <pod-name> -n retrogame

# Revisar configuración del deployment
kubectl describe deployment <deployment-name> -n retrogame
```

</Tab>
<Tab title="Solución">

**Paso 1: Identificar la causa raíz**

```bash
# Revisar logs detallados
kubectl logs <pod-name> -c <container-name> --previous -n retrogame

# Verificar variables de entorno
kubectl get deployment <deployment-name> -o yaml -n retrogame
```

**Paso 2: Soluciones comunes**

- **Error de configuración**: Verificar ConfigMaps y Secrets
- **Dependencias no disponibles**: Comprobar conectividad a BD/Redis
- **Recursos insuficientes**: Ajustar límites de memoria/CPU
- **Imagen incorrecta**: Verificar tag de imagen

**Paso 3: Aplicar corrección**

```bash
# Actualizar deployment
kubectl patch deployment <deployment-name> -n retrogame -p '{"spec":{"template":{"spec":{"containers":[{"name":"<container-name>","image":"<new-image>"}]}}}}'

# O editar directamente
kubectl edit deployment <deployment-name> -n retrogame
```

</Tab>
<Tab title="Prevención">

- Implementar health checks apropiados
- Configurar resource limits adecuados
- Usar imagePullPolicy: Always para tags latest
- Validar ConfigMaps antes del deploy
- Monitorear logs de aplicación continuamente
</Tab>
</Tabs>

### Problemas de Conexión a Base de Datos

<Tabs>
<Tab title="Síntomas">

**Indicadores del problema:**

- Error "connection refused" o timeout
- Aplicación no puede conectar a PostgreSQL
- Queries fallando intermitentemente
- Logs mostrando errores de conexión
</Tab>
<Tab title="Diagnóstico">

```bash
# Verificar estado del pod de PostgreSQL
kubectl get pods -n retrogame | grep postgres

# Revisar logs de PostgreSQL
kubectl logs postgres-deployment-xxx -n retrogame

# Probar conectividad desde la aplicación
kubectl exec -it api-deployment-xxx -n retrogame -- psql -h postgres-service -U retrogame -d retrogame
```

</Tab>
<Tab title="Solución">

**Verificar configuración de red:**

```bash
# Verificar servicios
kubectl get services -n retrogame

# Revisar endpoints
kubectl get endpoints postgres-service -n retrogame

# Verificar variables de entorno de la app
kubectl describe deployment api-deployment -n retrogame
```

**Soluciones comunes:**

- Verificar que el service name sea correcto
- Comprobar credenciales en secrets
- Reiniciar pods de PostgreSQL si es necesario
- Verificar network policies
</Tab>
<Tab title="Prevención">

- Implementar connection pooling
- Configurar health checks para PostgreSQL
- Monitorear métricas de conexiones
- Usar DNS names en lugar de IPs
- Configurar retry logic en la aplicación
</Tab>
</Tabs>

### Problemas de Autenticación JWT

<Tabs>
<Tab title="Síntomas">

**Indicadores del problema:**

- Tokens expirados prematuramente
- Error 401 Unauthorized
- JWT malformed o invalid signature
- Usuario no puede acceder tras login
</Tab>
<Tab title="Diagnóstico">

```bash
# Revisar configuración JWT en la aplicación
kubectl get configmap jwt-config -n retrogame -o yaml

# Verificar secrets JWT
kubectl get secret jwt-secret -n retrogame -o yaml

# Revisar logs de autenticación
kubectl logs api-deployment-xxx -n retrogame | grep -i jwt
```

</Tab>
<Tab title="Solución">

**Verificar configuración JWT:**

```yaml
# Ejemplo de ConfigMap corregido
apiVersion: v1
kind: ConfigMap
metadata:
  name: jwt-config
data:
  JWT_EXPIRATION: "24h"
  JWT_REFRESH_EXPIRATION: "7d"
  JWT_ALGORITHM: "HS256"
```

**Pasos de corrección:**

1. Verificar que JWT_SECRET esté configurado
2. Comprobar algoritmo de firma
3. Validar tiempo de expiración
4. Reiniciar pods de la API
</Tab>
<Tab title="Prevención">

- Usar secrets seguros para JWT_SECRET
- Implementar refresh token rotation
- Monitorear tasas de tokens expirados
- Configurar logout apropiado
- Implementar blacklist de tokens
</Tab>
</Tabs>

## Herramientas de Diagnóstico

### Scripts de Diagnóstico Rápido

```bash
#!/bin/bash
# health-check.sh - Diagnóstico general del cluster

echo "=== RetroGameCloud Health Check ==="

# Verificar pods
echo "1. Estado de Pods:"
kubectl get pods -n retrogame

# Verificar servicios
echo -e "\n2. Estado de Servicios:"
kubectl get services -n retrogame

# Verificar ingress
echo -e "\n3. Estado de Ingress:"
kubectl get ingress -n retrogame

# Verificar recursos
echo -e "\n4. Uso de Recursos:"
kubectl top pods -n retrogame
```

### Logs Centralizados

Para diagnóstico avanzado, usa los logs centralizados:

```bash
# Ver logs de todos los pods de la API
kubectl logs -l app=api -n retrogame --tail=100

# Seguir logs en tiempo real
kubectl logs -f deployment/api-deployment -n retrogame

# Filtrar errores
kubectl logs deployment/api-deployment -n retrogame | grep -i error
```

## Contacto y Escalación

<Warning>
Si los problemas persisten después de seguir esta guía, documenta los siguientes datos antes de escalar:

1. **Síntomas exactos** y cuándo comenzaron
2. **Logs relevantes** (últimas 100 líneas)
3. **Configuración actual** (deployment YAML)
4. **Pasos ya intentados** y sus resultados
5. **Impacto en usuarios** y urgencia
</Warning>

### Canales de Escalación

- **Incidentes Críticos**: Contactar al equipo de DevOps inmediatamente
- **Problemas Menores**: Crear ticket en el sistema de tracking
- **Consultas Técnicas**: Canal #technical-support en Slack

---

<Info>
Este documento se actualiza continuamente basándose en los problemas más frecuentes reportados. Contribuye con nuevos casos y soluciones cuando encuentres problemas únicos.
</Info>