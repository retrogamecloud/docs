---
title: 4.1. Visión General del Frontend
description: Interfaz de usuario retro para jugar juegos clásicos de DOS
icon: display
---

## Arquitectura del Frontend

El frontend de Retro Game Hub es una aplicación web estática con diseño retro años 80, enfocada en proporcionar una experiencia nostálgica de terminal para jugar juegos clásicos de DOS.

### Características Principales

<CardGroup cols={2}>
  <Card title="Diseño Retro" icon="terminal">
    Estética de terminal CRT años 80
  </Card>
  <Card title="js-dos Integration" icon="gamepad">
    Emulador DOSBox en el navegador
  </Card>
  <Card title="Autenticación JWT" icon="key">
    Sistema seguro de login/registro
  </Card>
  <Card title="Rankings en Vivo" icon="trophy">
    Leaderboards actualizados en tiempo real
  </Card>
</CardGroup>

## Stack Tecnológico

```yaml
Frontend:
  - HTML5/CSS3/JavaScript vanilla
  - js-dos 7.xx (DOSBox WebAssembly)
  - Font: VT323 (Google Fonts)
  - Sin frameworks: Máximo rendimiento

Servidor:
  - Node.js + Express
  - Puerto: 3001
  - Sirve archivos estáticos
  - Proxy a servicios backend

CDN:
  - Nginx para juegos (.jsdos)
  - CloudFront para distribución global
  - Cache agresivo de assets

```

## Estructura de Archivos

```

frontend/
├── server.js              # Express server
├── package.json          # Dependencias
├── Dockerfile           # Contenedor para K8s
├── index.html          # Landing page + Auth
├── games.html         # Game selection grid
├── health.html       # Health check page
├── retro.css        # Estilos retro globales
├── score-tracker.js # Gestión de puntuaciones
└── jsdos/          # js-dos library
    ├── js-dos.js
    ├── wdosbox.js
    └── emulators/

```

## Páginas Principales

### Landing Page (index.html)

<Accordion title="Ver detalles de index.html">

La página principal incluye:

* *Características:**

- Sistema de login/registro con JWT

- Validación de formularios en tiempo real

- Diseño responsive con grid animado

- Efecto CRT con scanlines y flicker

- Modal para entrar credenciales

* *Funcionalidades:**

```javascript
// Autenticación

- Login: POST /api/auth/login

- Register: POST /api/auth/register

- Token almacenado en localStorage

- Auto-redirect a games.html si autenticado

// Validaciones

- Email formato válido

- Username: 3-20 caracteres

- Password: mínimo 6 caracteres

- Confirmación de password

```

</Accordion>

### Game Selection (games.html)

<Accordion title="Ver detalles de games.html">

Grid de selección de juegos con:

* *Layout:**

- Grid responsive 3 columnas (desktop)

- Cards con información del juego

- Preview images y metadata

- Botón "Jugar" por juego

* *Juegos Disponibles:**
1. Dangerous Dave 2
2. Digger
3. DOOM
4. Duke Nukem 3D
5. Heroes of Might and Magic II
6. The Lost Vikings
7. Mortal Kombat
8. Street Fighter II
9. Tetris
10. Wolfenstein 3D

* *Integración:**

```javascript
// Carga de juego
1. Click en "Jugar"
2. Fetch .jsdos desde CDN
3. Inicializar js-dos con bundle
4. Pantalla completa automática
5. Score tracker activado

```

</Accordion>

### Health Check (health.html)

Simple página para Kubernetes liveness/readiness probes:

```html
<!DOCTYPE html>
<html>
<head><title>Health Check</title></head>
<body><h1>OK</h1></body>
</html>

```

## Sistema de Estilos (retro.css)

### Paleta de Colores

```css
:root {
  --retro-green: #00ff88;
  --retro-dark: #001100;
  --retro-black: #000000;
  --retro-glow: 0 0 10px #00ff88;
}

```

### Efectos Visuales

<Tabs>
  <Tab title="CRT Flicker">
    ```css
    @keyframes crtFlicker {
      0%, 100% { opacity: 0.98; }
      50% { opacity: 1; }
    }

    body {
      animation: crtFlicker 2s infinite;
    }
    ```

  </Tab>

  <Tab title="Scanlines">
    ```css
    body::before {
      content: "";
      position: fixed;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0, 255, 136, 0.05),
        transparent 2px
      );
      pointer-events: none;
    }
    ```

  </Tab>

  <Tab title="Animated Grid">
    ```css
    @keyframes moveGrid {
      to { background-position: 40px 40px; }
    }

    .grid-background {
      background-image:
        linear-gradient(#004400 1px, transparent 1px),
        linear-gradient(90deg, #004400 1px, transparent 1px);
      background-size: 40px 40px;
      animation: moveGrid 4s linear infinite;
    }
    ```

  </Tab>
</Tabs>

### Componentes Estilizados

```css
/* Buttons */
.retro-button {
  background: transparent;
  border: 2px solid var(--retro-green);
  color: var(--retro-green);
  text-shadow: var(--retro-glow);
  transition: 0.3s;
}

.retro-button:hover {
  background: var(--retro-green);
  color: black;
  box-shadow: 0 0 20px var(--retro-green);
}

/* Input Fields */
.retro-input {
  background: black;
  border: 2px solid var(--retro-green);
  color: var(--retro-green);
  font-family: 'VT323', monospace;
}

/* Cards */
.game-card {
  background: rgba(0, 17, 0, 0.8);
  border: 2px solid var(--retro-green);
  box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
}

```

## Score Tracker (score-tracker.js)

Sistema de seguimiento de puntuaciones integrado con el emulador.

### Inicialización

```javascript
class ScoreTracker {
  constructor(gameId, userId, token) {
    this.gameId = gameId;
    this.userId = userId;
    this.token = token;
    this.currentScore = 0;
    this.sessionId = this.generateSessionId();
  }

  async startTracking() {
    // Monitoreo de memoria DOSBox
    // Polling cada 5 segundos
    // Detección de cambios en score
  }
}

```

### Detección de Score

<Accordion title="Métodos de detección">

* *1. Memory Scanning:**

```javascript
// Leer memoria del emulador
const memory = dosInstance.getMemory();
const scoreAddress = this.findScoreAddress(gameId);
const newScore = memory.readUint32(scoreAddress);

```

* *2. Pattern Matching:**

```javascript
// Buscar patrones conocidos
const patterns = {
  'doom': [0x10000, 0x20000],
  'tetris': [0x5000, 0x6000]
};

```

* *3. Heurísticas:**

- Incrementos detectados

- Validación de rangos

- Anti-cheat básico

</Accordion>

### Envío de Scores

```javascript
async submitScore(score) {
  try {
    const response = await fetch('/api/scores', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${this.token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        gameId: this.gameId,
        score: score,
        sessionId: this.sessionId,
        timestamp: Date.now()
      })
    });

    if (response.ok) {
      this.showNotification('¡Score guardado!');
      this.updateLeaderboard();
    }
  } catch (error) {
    console.error('Error submitting score:', error);
  }
}

```

## Integración con Backend

### API Endpoints Consumidos

```yaml
Auth Service:
  - POST /api/auth/login
  - POST /api/auth/register
  - GET /api/auth/verify

Game Catalog:
  - GET /api/games
  - GET /api/games/:id

Score Service:
  - POST /api/scores
  - GET /api/scores/user/:userId
  - GET /api/scores/game/:gameId

Ranking Service:
  - GET /api/rankings/game/:gameId/top
  - GET /api/rankings/global
  - GET /api/rankings/user/:userId/position

```

### Headers Requeridos

```javascript
const headers = {
  'Authorization': `Bearer ${localStorage.getItem('token')}`,
  'Content-Type': 'application/json'
};

```

## Deployment

### Docker Container

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

EXPOSE 3001

HEALTHCHECK --interval=30s --timeout=3s \
  CMD node -e "require('http').get('http://localhost:3001/health', (r) => {process.exit(r.statusCode === 200 ? 0 : 1)})"

CMD ["node", "server.js"]

```

### Kubernetes Service

```yaml
apiVersion: v1
kind: Service
metadata:
  name: frontend
spec:
  selector:
    app: frontend
  ports:
    - port: 80
      targetPort: 3001
  type: ClusterIP

```

### Ingress Configuration

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: frontend-ingress
  annotations:
    kubernetes.io/ingress.class: "nginx"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
spec:
  tls:
    - hosts:
        - retrogamehub.games
      secretName: frontend-tls
  rules:
    - host: retrogamehub.games
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: frontend
                port:
                  number: 80

```

## Performance Optimization

### Caching Strategy

```javascript
// Service Worker para cache offline
self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open('retrogame-v1').then((cache) => {
      return cache.addAll([
        '/',
        '/games.html',
        '/retro.css',
        '/score-tracker.js',
        '/jsdos/js-dos.js'
      ]);
    })
  );
});

```

### Asset Optimization

- **Minificación:** CSS/JS comprimidos en producción

- **CDN:** Juegos servidos desde CloudFront

- **Lazy Loading:** js-dos cargado bajo demanda

- **Preconnect:** DNS prefetch para CDN

```html
<link rel="preconnect" href="https://cdn.retrogamehub.games">
<link rel="dns-prefetch" href="https://cdn.retrogamehub.games">

```

## Seguridad

### Content Security Policy

```javascript
app.use((req, res, next) => {
  res.setHeader(
    'Content-Security-Policy',
    "default-src 'self'; " +
    "script-src 'self' 'unsafe-inline' 'unsafe-eval'; " +
    "style-src 'self' 'unsafe-inline' fonts.googleapis.com; " +
    "font-src 'self' fonts.gstatic.com; " +
    "connect-src 'self' https://api.retrogamehub.games; " +
    "img-src 'self' data: https:;"
  );
  next();
});

```

### XSS Protection

```javascript
// Sanitización de inputs
function sanitizeInput(input) {
  return input
    .replace(/[<>]/g, '')
    .trim()
    .substring(0, 100);
}

// Validación JWT
function verifyToken(token) {
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    return decoded;
  } catch (error) {
    return null;
  }
}

```

## Próximos Pasos

<CardGroup cols={2}>
  <Card title="js-dos Integration" icon="gamepad" href="/frontend/jsdos-integration">
    Detalles de integración del emulador
  </Card>
  <Card title="Score Tracking" icon="chart-line" href="/services/score-service">
    Sistema de puntuaciones detallado
  </Card>
</CardGroup>
