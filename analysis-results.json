{
  "analysis_summary": "Documentación extensa pero desorganizada. Mezcla contenido duplicado (essentials, development.mdx obsoleto), falta documentación técnica crítica (base de datos, seguridad, respaldo), y necesita consolidación en estructura más coherente. Puntos fuertes: cobertura de servicios y CI/CD.",
  "overall_score": 6.5,
  "improvements": [
    {
      "priority": "high",
      "category": "structure",
      "title": "Eliminar documentación obsoleta y duplicada",
      "description": "Varios archivos están duplicados o son plantillas no utilizadas. development.mdx es plantilla de Mintlify, essentials/* son ejemplos genéricos, y docs/api/auth-register.mdx duplica api-reference/auth/register.mdx",
      "files_to_create": [],
      "files_to_modify": [],
      "files_to_delete": [
        "development.mdx",
        "essentials/images.mdx",
        "essentials/navigation.mdx",
        "essentials/markdown.mdx",
        "essentials/code.mdx",
        "essentials/settings.mdx",
        "docs/api/auth-register.mdx",
        "snippets/snippet-intro.mdx"
      ],
      "proposed_content": "",
      "mermaid_diagram": "",
      "rationale": "Reduce confusión, mejora mantenibilidad y evita información contradictoria. La carpeta essentials son ejemplos de Mintlify sin contenido real del proyecto."
    },
    {
      "priority": "high",
      "category": "content",
      "title": "Documentar esquema y arquitectura de base de datos",
      "description": "No existe documentación del modelo de datos, esquema PostgreSQL, relaciones entre tablas ni estrategias de indexación. Crítico para desarrollo y debugging.",
      "files_to_create": [
        "infrastructure/database.mdx",
        "infrastructure/database-schema.mdx"
      ],
      "files_to_modify": [
        "infrastructure/overview.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentación completa del esquema PostgreSQL incluyendo: tablas (users, games, scores, rankings), relaciones, índices, migraciones, estrategia de backup, configuración RDS, políticas de retención, y ejemplos de consultas comunes.",
      "mermaid_diagram": "erDiagram\n    USERS ||--o{ SCORES : guarda\n    USERS ||--o{ RANKINGS : aparece\n    GAMES ||--o{ SCORES : tiene\n    GAMES ||--o{ RANKINGS : tiene\n    USERS {\n        uuid id PK\n        varchar username UK\n        varchar email UK\n        varchar password_hash\n        varchar display_name\n        varchar avatar_url\n        text bio\n        timestamp created_at\n    }\n    GAMES {\n        uuid id PK\n        varchar slug UK\n        varchar name\n        text description\n        varchar jsdos_url\n        varchar thumbnail_url\n        varchar category\n        int year\n        timestamp created_at\n    }\n    SCORES {\n        uuid id PK\n        uuid user_id FK\n        uuid game_id FK\n        int score\n        json metadata\n        timestamp achieved_at\n        timestamp created_at\n    }\n    RANKINGS {\n        uuid id PK\n        uuid game_id FK\n        uuid user_id FK\n        int rank\n        int score\n        timestamp updated_at\n    }",
      "rationale": "Base de datos es componente crítico sin documentación. Desarrolladores necesitan entender modelo de datos para modificar servicios o diagnosticar problemas."
    },
    {
      "priority": "high",
      "category": "diagrams",
      "title": "Diagrama de arquitectura completa con flujo de datos",
      "description": "El diagrama actual en architecture.mdx está incompleto. Falta mostrar flujo de datos completo desde CDN hasta base de datos, incluyendo Kong, servicios, y comunicación interna.",
      "files_to_create": [],
      "files_to_modify": [
        "architecture.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Ampliar sección de arquitectura con diagrama completo mostrando: flujo de assets estáticos (CloudFront->S3), flujo de API (ALB->OAuth2->Kong->Servicios->RDS), comunicación interna entre servicios, y capa de monitorización.",
      "mermaid_diagram": "graph TB\n    subgraph Internet\n        U[Usuario]\n    end\n    subgraph AWS_CloudFront\n        CF[CloudFront CDN]\n        S3[S3 Bucket<br/>Assets Estáticos]\n    end\n    subgraph AWS_Route53\n        R53[Route53 DNS<br/>retrogamehub.com]\n    end\n    subgraph AWS_EKS_Cluster\n        ALB[Application Load Balancer<br/>SSL/TLS]\n        OAuth[OAuth2 Proxy<br/>GitHub Auth]\n        Kong[Kong API Gateway<br/>Rate Limiting, CORS]\n        subgraph Microservicios\n            Auth[Auth Service<br/>:3001]\n            User[User Service<br/>:3002]\n            Catalog[Game Catalog<br/>:3003]\n            Score[Score Service<br/>:3004]\n            Ranking[Ranking Service<br/>:3005]\n        end\n        Frontend[Frontend<br/>JS-DOS Emulator]\n    end\n    subgraph AWS_RDS\n        DB[(PostgreSQL<br/>Base de Datos)]\n    end\n    subgraph Monitorización\n        CW[CloudWatch<br/>Logs y Métricas]\n        Prom[Prometheus<br/>Métricas K8s]\n    end\n    U -->|HTTPS| R53\n    R53 --> CF\n    R53 --> ALB\n    CF --> S3\n    CF --> Frontend\n    ALB --> OAuth\n    OAuth -->|Token JWT| Kong\n    Kong --> Auth\n    Kong --> User\n    Kong --> Catalog\n    Kong --> Score\n    Kong --> Ranking\n    Kong --> Frontend\n    Auth --> DB\n    User --> DB\n    Catalog --> DB\n    Score --> DB\n    Ranking --> DB\n    Auth -.->|Logs| CW\n    Kong -.->|Métricas| Prom\n    EKS_Cluster -.->|Logs| CW",
      "rationale": "Diagrama actual está simplificado y no muestra flujo real de datos. Equipo necesita entender path completo de requests para debugging y optimización."
    },
    {
      "priority": "high",
      "category": "content",
      "title": "Documentar seguridad y gestión de secretos",
      "description": "No existe documentación sobre cómo se gestionan secretos (JWT secrets, DB passwords, OAuth tokens), políticas de seguridad, rotación de credenciales ni mejores prácticas.",
      "files_to_create": [
        "infrastructure/security.mdx",
        "infrastructure/secrets-management.mdx"
      ],
      "files_to_modify": [
        "infrastructure/overview.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentar: uso de AWS Secrets Manager/Parameter Store, rotación de secretos, políticas IAM, seguridad de red (Security Groups, NACLs), cifrado en tránsito y reposo, gestión de tokens JWT, configuración OAuth2, y checklist de seguridad pre-producción.",
      "mermaid_diagram": "",
      "rationale": "Seguridad es crítica en producción. Falta documentación sobre gestión de credenciales, lo cual es riesgo de seguridad y bloquea despliegues seguros."
    },
    {
      "priority": "high",
      "category": "content",
      "title": "Documentar estrategia de respaldo y recuperación ante desastres",
      "description": "No hay documentación sobre backups de base de datos, estrategia de DR (Disaster Recovery), RPO/RTO, ni procedimientos de restauración.",
      "files_to_create": [
        "infrastructure/backup-recovery.mdx"
      ],
      "files_to_modify": [
        "infrastructure/overview.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentar: configuración de automated backups en RDS, snapshots manuales, retención de backups, procedimiento de restauración paso a paso, pruebas de DR, RPO objetivo (Recovery Point Objective), RTO objetivo (Recovery Time Objective), y runbook de recuperación de desastres.",
      "mermaid_diagram": "",
      "rationale": "En producción es obligatorio tener plan de DR documentado. Pérdida de datos o downtime prolongado son riesgos críticos sin documentación de recuperación."
    },
    {
      "priority": "medium",
      "category": "structure",
      "title": "Consolidar documentación de API duplicada",
      "description": "Existe duplicación entre carpetas api-reference/auth/, api-reference/games/, etc. y services/. La estructura services/ documenta servicios desde perspectiva arquitectónica, mientras api-reference/ documenta endpoints. Falta claridad en separación.",
      "files_to_create": [
        "api-reference/README.mdx"
      ],
      "files_to_modify": [
        "services/auth-service.mdx",
        "services/game-catalog.mdx",
        "services/score-service.mdx",
        "services/ranking-service.mdx",
        "services/user-service.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "En services/*.mdx enfocarse en arquitectura, responsabilidades, dependencias y diseño interno. En api-reference/* enfocarse únicamente en contratos de API (endpoints, payloads, respuestas). Añadir README.mdx explicando diferencia entre ambas secciones.",
      "mermaid_diagram": "",
      "rationale": "Separación clara entre documentación de arquitectura y referencia de API mejora usabilidad. Desarrolladores backend leen services/, consumidores de API leen api-reference/."
    },
    {
      "priority": "medium",
      "category": "diagrams",
      "title": "Diagrama de flujo de despliegue CI/CD completo",
      "description": "La documentación de CI/CD está fragmentada entre cicd/github-actions.mdx y cicd/gitops-workflow.mdx. Falta diagrama visual del pipeline completo desde commit hasta producción.",
      "files_to_create": [],
      "files_to_modify": [
        "cicd/overview.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Agregar diagrama de flujo completo mostrando: commit a GitHub -> GitHub Actions (build, test, Docker build) -> push a ECR -> ArgoCD detecta cambio -> sincroniza K8s -> health checks -> rollout completo.",
      "mermaid_diagram": "graph LR\n    A[Git Commit<br/>main branch] --> B[GitHub Actions<br/>Trigger]\n    B --> C[Build & Test<br/>npm test]\n    C --> D[Docker Build<br/>multi-stage]\n    D --> E[Push Image<br/>AWS ECR]\n    E --> F[Update Manifest<br/>kubernetes repo]\n    F --> G[ArgoCD<br/>Detecta Cambio]\n    G --> H[Sync Cluster<br/>kubectl apply]\n    H --> I[Rolling Update<br/>Zero Downtime]\n    I --> J[Health Checks<br/>Liveness/Readiness]\n    J --> K{Deploy OK?}\n    K -->|Sí| L[Despliegue Completo]\n    K -->|No| M[Rollback Automático]\n    M --> N[Notificación Slack]\n    L --> O[Notificación Slack]",
      "rationale": "Pipeline CI/CD es complejo y visual ayuda a entender flujo completo. Nuevo desarrollador necesita ver proceso end-to-end de despliegue."
    },
    {
      "priority": "medium",
      "category": "content",
      "title": "Documentar límites y cuotas de API (rate limiting)",
      "description": "Se menciona rate limiting en Kong pero no hay documentación de límites específicos por endpoint, cuotas por usuario, ni manejo de errores 429.",
      "files_to_create": [
        "api-reference/rate-limits.mdx"
      ],
      "files_to_modify": [
        "api-reference/introduction.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentar: rate limits por endpoint (ej: 100 req/min autenticación, 1000 req/min lectura catálogo), límites por usuario vs anónimo, headers de respuesta (X-RateLimit-Limit, X-RateLimit-Remaining), manejo de 429 Too Many Requests, y estrategias de retry con backoff exponencial.",
      "mermaid_diagram": "",
      "rationale": "Consumidores de API necesitan conocer límites para implementar lógica de retry correctamente. Evita sorpresas y mejora experiencia de desarrollo."
    },
    {
      "priority": "medium",
      "category": "diagrams",
      "title": "Diagrama de comunicación entre microservicios",
      "description": "No está claro cómo se comunican los servicios entre sí. Por ejemplo, cuando Score Service guarda un score, ¿cómo se actualiza Ranking Service? ¿Event-driven? ¿Llamadas síncronas?",
      "files_to_create": [],
      "files_to_modify": [
        "architecture.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Agregar sección sobre comunicación inter-servicios explicando si es síncrona (HTTP), asíncrona (mensajería), o híbrida. Incluir diagrama de dependencias.",
      "mermaid_diagram": "graph TD\n    subgraph Cliente\n        C[Cliente Frontend]\n    end\n    subgraph Kong_Gateway\n        K[Kong]\n    end\n    subgraph Servicios\n        A[Auth Service<br/>Independiente]\n        U[User Service<br/>Depende: Auth]\n        G[Game Catalog<br/>Independiente]\n        S[Score Service<br/>Depende: Auth, User]\n        R[Ranking Service<br/>Depende: Score]\n    end\n    C -->|JWT| K\n    K --> A\n    K --> U\n    K --> G\n    K --> S\n    K --> R\n    S -.->|Consulta Usuario| U\n    S -.->|Valida Token| A\n    R -.->|Lee Scores| S\n    style A fill:#90EE90\n    style G fill:#90EE90\n    style S fill:#FFB6C1\n    style R fill:#FFB6C1\n    style U fill:#87CEEB",
      "rationale": "Entender dependencias entre servicios es fundamental para debugging, planificación de cambios y entender impacto de fallos en cascada."
    },
    {
      "priority": "medium",
      "category": "content",
      "title": "Documentar proceso de subida de nuevos juegos",
      "description": "No está documentado cómo se agregan juegos al catálogo: ¿dónde se suben archivos .jsdos?, ¿cómo se crea metadata?, ¿hay interfaz admin?, ¿es proceso manual?",
      "files_to_create": [
        "operations/game-management.mdx"
      ],
      "files_to_modify": [
        "services/game-catalog.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentar proceso completo: preparación de archivo .jsdos, creación de thumbnail, subida a S3, inserción de metadata en BD, generación de slug único, proceso de validación, y ejemplo de script de automatización. Incluir checklist de calidad.",
      "mermaid_diagram": "",
      "rationale": "Operación común que necesita documentación clara. Sin proceso definido, agregar juegos es ad-hoc y propenso a errores."
    },
    {
      "priority": "medium",
      "category": "quality",
      "title": "Estandarizar formato de frontmatter en archivos MDX",
      "description": "Los archivos tienen frontmatter inconsistente: algunos usan 'icon: file-lines' genérico, otros tienen iconos específicos. Descripciones varían en longitud y detalle.",
      "files_to_create": [
        "CONTRIBUTING.md"
      ],
      "files_to_modify": [],
      "files_to_delete": [],
      "proposed_content": "Crear guía de estilo para documentación definiendo: estructura de frontmatter obligatoria (title, description, icon), convenciones de naming, longitud de descripciones (50-150 chars), y uso consistente de iconos por tipo de documento (services=gamepad, infrastructure=server, etc).",
      "mermaid_diagram": "",
      "rationale": "Consistencia mejora profesionalismo y usabilidad. Guía de estilo facilita contribuciones y mantiene calidad uniforme."
    },
    {
      "priority": "low",
      "category": "content",
      "title": "Documentar costos estimados de infraestructura AWS",
      "description": "No hay información sobre costos mensuales estimados de ejecutar la infraestructura (EKS, RDS, CloudFront, etc.).",
      "files_to_create": [
        "infrastructure/cost-estimation.mdx"
      ],
      "files_to_modify": [
        "infrastructure/overview.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentar costos estimados mensuales por servicio: EKS cluster (~$73/mes), RDS PostgreSQL según tier, CloudFront según tráfico, Route53 ($0.50/hosted zone), ALB (~$16/mes). Incluir calculadora de costos según escala esperada.",
      "mermaid_diagram": "",
      "rationale": "Información financiera ayuda en planificación y toma de decisiones. Equipos necesitan estimar budget antes de despliegue."
    },
    {
      "priority": "low",
      "category": "content",
      "title": "Documentar estrategia de testing",
      "description": "No hay documentación sobre tipos de tests (unitarios, integración, e2e), cobertura esperada, ni cómo ejecutar test suites.",
      "files_to_create": [
        "development/testing.mdx"
      ],
      "files_to_modify": [
        "desarrollo-local.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Documentar estrategia de testing: tests unitarios con Jest para servicios, tests de integración para APIs, tests e2e con Playwright para frontend, cobertura mínima (80%), comandos para ejecutar tests, y guía para escribir nuevos tests.",
      "mermaid_diagram": "",
      "rationale": "Testing es práctica crítica pero no documentada. Desarrolladores necesitan saber qué tests escribir y cómo ejecutarlos."
    },
    {
      "priority": "low",
      "category": "diagrams",
      "title": "Diagrama de flujo de autenticación OAuth2 completo",
      "description": "sequence-diagrams.mdx tiene diagrama de autenticación pero falta detalle del flujo OAuth2 con GitHub (redirects, callbacks, exchange de tokens).",
      "files_to_create": [],
      "files_to_modify": [
        "sequence-diagrams.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Agregar diagrama de secuencia detallado del flujo OAuth2 mostrando: usuario hace login -> redirect a GitHub -> usuario autoriza -> callback con code -> exchange code por token -> validación -> emisión JWT interno.",
      "mermaid_diagram": "sequenceDiagram\n    actor Usuario\n    participant Frontend\n    participant OAuth2Proxy\n    participant GitHub\n    participant AuthService\n    participant DB\n    Usuario->>Frontend: Click Login con GitHub\n    Frontend->>OAuth2Proxy: Redirect /oauth2/start\n    OAuth2Proxy->>GitHub: Redirect authorization_url<br/>client_id, scope, state\n    GitHub->>Usuario: Pantalla Autorización\n    Usuario->>GitHub: Autoriza Aplicación\n    GitHub->>OAuth2Proxy: Callback con code\n    OAuth2Proxy->>GitHub: POST /access_token<br/>code, client_secret\n    GitHub->>OAuth2Proxy: access_token\n    OAuth2Proxy->>GitHub: GET /user<br/>Bearer token\n    GitHub->>OAuth2Proxy: Datos usuario\n    OAuth2Proxy->>AuthService: POST /auth/github<br/>email, username, avatar\n    AuthService->>DB: Buscar o Crear Usuario\n    DB->>AuthService: Usuario ID\n    AuthService->>AuthService: Generar JWT<br/>HS256, exp 24h\n    AuthService->>OAuth2Proxy: JWT token\n    OAuth2Proxy->>Frontend: Set-Cookie: auth_token\n    Frontend->>Usuario: Redirigir a Dashboard",
      "rationale": "OAuth2 es complejo y diagrama detallado ayuda a entender flujo completo, especialmente útil para debugging de problemas de autenticación."
    },
    {
      "priority": "low",
      "category": "new_section",
      "title": "Agregar sección de troubleshooting por servicio",
      "description": "troubleshooting.mdx es genérico. Sería útil tener troubleshooting específico por servicio con problemas comunes y soluciones.",
      "files_to_create": [
        "troubleshooting/auth-service.mdx",
        "troubleshooting/score-service.mdx",
        "troubleshooting/ranking-service.mdx"
      ],
      "files_to_modify": [
        "troubleshooting.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "Crear páginas de troubleshooting específicas con problemas comunes: Auth Service (JWT expirado, usuario duplicado), Score Service (score no se guarda, validación falla), Ranking Service (ranking desactualizado). Incluir logs de ejemplo y comandos de diagnóstico.",
      "mermaid_diagram": "",
      "rationale": "Troubleshooting específico por servicio acelera resolución de problemas. Problemas comunes documentados evitan escalaciones innecesarias."
    }
  ],
  "new_sections": [
    {
      "name": "Operaciones",
      "description": "Documentación de tareas operativas comunes: gestión de juegos, monitorización, escalado, mantenimiento",
      "files": [
        {
          "filename": "operations/overview.mdx",
          "title": "Operaciones - Visión General",
          "content_outline": "Introducción a tareas operativas: runbooks, procedimientos estándar, on-call, y enlaces a subsecciones (game-management, scaling, maintenance)"
        },
        {
          "filename": "operations/game-management.mdx",
          "title": "Gestión de Catálogo de Juegos",
          "content_outline": "Proceso de agregar/eliminar juegos: preparación de archivos .jsdos, metadata, thumbnails, subida a S3, inserción en BD, validación"
        },
        {
          "filename": "operations/scaling.mdx",
          "title": "Escalado y Dimensionamiento",
          "content_outline": "HPA (Horizontal Pod Autoscaler) configurado, métricas de escalado (CPU, memoria, requests/sec), escalado manual, límites de pods, escalado de RDS"
        },
        {
          "filename": "operations/maintenance.mdx",
          "title": "Mantenimiento Programado",
          "content_outline": "Ventanas de mantenimiento, actualización de dependencias, rotación de certificados SSL, limpieza de logs antiguos, optimización de BD"
        }
      ]
    },
    {
      "name": "Arquitectura de Datos",
      "description": "Documentación completa del modelo de datos, esquema de BD, migraciones y queries comunes",
      "files": [
        {
          "filename": "data-architecture/overview.mdx",
          "title": "Arquitectura de Datos - Visión General",
          "content_outline": "Introducción al modelo de datos: PostgreSQL, esquema relacional, principios de diseño, estrategia de versionado"
        },
        {
          "filename": "data-architecture/schema.mdx",
          "title": "Esquema de Base de Datos",
          "content_outline": "Descripción completa de tablas (users, games, scores, rankings), columnas, tipos de datos, constraints, índices, relaciones con diagramas ER"
        },
        {
          "filename": "data-architecture/migrations.mdx",
          "title": "Migraciones de Base de Datos",
          "content_outline": "Estrategia de migraciones: herramienta usada (Flyway, Liquibase, etc), convenciones de naming, rollback, historial de migraciones, ejemplos"
        },
        {
          "filename": "data-architecture/queries.mdx",
          "title": "Consultas Comunes",
          "content_outline": "Queries SQL frecuentes: top scores por juego, ranking global, estadísticas de usuario, queries de reportes, optimización de performance"
        }
      ]
    },
    {
      "name": "Monitorización y Observabilidad",
      "description": "Guías de monitorización, dashboards, alertas y análisis de logs",
      "files": [
        {
          "filename": "monitoring/overview.mdx",
          "title": "Monitorización - Visión General",
          "content_outline": "Stack de observabilidad: CloudWatch, Prometheus, Grafana (si aplica), filosofía de monitorización (métricas, logs, traces)"
        },
        {
          "filename": "monitoring/metrics.mdx",
          "title": "Métricas Clave",
          "content_outline": "Métricas importantes por servicio: latencia p50/p95/p99, throughput (req/sec), tasa de errores, uso de recursos (CPU, memoria), métricas de negocio (juegos jugados, usuarios activos)"
        },
        {
          "filename": "monitoring/alerts.mdx",
          "title": "Configuración de Alertas",
          "content_outline": "Alertas configuradas: umbrales críticos, canales de notificación (Slack, PagerDuty), severidad (critical, warning, info), runbooks asociados"
        },
        {
          "filename": "monitoring/logs.mdx",
          "title": "Análisis de Logs",
          "content_outline": "Centralización de logs en CloudWatch, formato estructurado (JSON), queries útiles, correlación de logs entre servicios, retención de logs"
        }
      ]
    }
  ],
  "diagrams_needed": [
    {
      "type": "component",
      "title": "Diagrama de Componentes y Dependencias",
      "description": "Muestra todos los componentes del sistema con sus dependencias externas (AWS services, librerías) y puertos de comunicación",
      "location": "architecture.mdx - nueva sección Componentes Detallados",
      "mermaid_code": "graph TB\n    subgraph Frontend\n        FE[React App<br/>Port 3000]\n        JSDOS[JS-DOS Emulator<br/>v7.x]\n    end\n    subgraph Backend_Services\n        Auth[Auth Service<br/>Node.js + Express<br/>Port 3001]\n        User[User Service<br/>Node.js + Express<br/>Port 3002]\n        Catalog[Catalog Service<br/>Node.js + Express<br/>Port 3003]\n        Score[Score Service<br/>Node.js + Express<br/>Port 3004]\n        Ranking[Ranking Service<br/>Node.js + Express<br/>Port 3005]\n    end\n    subgraph Dependencias_NPM\n        JWT[jsonwebtoken]\n        Bcrypt[bcrypt]\n        PG[pg - PostgreSQL Client]\n        Express[express]\n        Cors[cors]\n    end\n    subgraph AWS_Services\n        RDS[(RDS PostgreSQL<br/>Port 5432)]\n        S3[S3 Bucket<br/>Game Assets]\n        Secrets[Secrets Manager]\n        CW[CloudWatch Logs]\n    end\n    FE --> JSDOS\n    Auth --> JWT\n    Auth --> Bcrypt\n    Auth --> PG\n    Auth --> Express\n    User --> PG\n    User --> Express\n    Catalog --> PG\n    Score --> PG\n    Ranking --> PG\n    PG --> RDS\n    Catalog --> S3\n    Auth --> Secrets\n    Auth --> CW\n    User --> CW\n    Catalog --> CW\n    Score --> CW\n    Ranking --> CW"
    },
    {
      "type": "sequence",
      "title": "Flujo Completo de Guardado de Score",
      "description": "Muestra interacción completa cuando usuario guarda un score: desde frontend hasta actualización de ranking",
      "location": "sequence-diagrams.mdx - nueva sección Guardado de Score",
      "mermaid_code": "sequenceDiagram\n    actor Jugador\n    participant Frontend\n    participant Kong\n    participant ScoreService\n    participant RankingService\n    participant DB\n    Jugador->>Frontend: Termina Juego<br/>Score: 9500\n    Frontend->>Frontend: Captura Score<br/>gameId, score\n    Frontend->>Kong: POST /api/scores<br/>Bearer JWT<br/>{gameId, score, metadata}\n    Kong->>Kong: Valida Rate Limit<br/>Verifica JWT\n    Kong->>ScoreService: Forward Request\n    ScoreService->>ScoreService: Extrae userId de JWT\n    ScoreService->>DB: BEGIN TRANSACTION\n    ScoreService->>DB: SELECT score FROM scores<br/>WHERE userId AND gameId\n    DB->>ScoreService: currentScore: 8000\n    ScoreService->>ScoreService: Comparar<br/>9500 > 8000\n    ScoreService->>DB: UPDATE scores<br/>SET score=9500<br/>WHERE userId AND gameId\n    DB->>ScoreService: Updated 1 row\n    ScoreService->>DB: COMMIT TRANSACTION\n    ScoreService->>RankingService: POST /internal/recalculate<br/>{gameId}\n    RankingService->>DB: SELECT TOP 100<br/>ORDER BY score DESC\n    DB->>RankingService: Lista ordenada\n    RankingService->>DB: UPDATE rankings<br/>SET rank positions\n    RankingService->>ScoreService: 200 OK\n    ScoreService->>Kong: 200 OK<br/>{score: 9500, rank: 3}\n    Kong->>Frontend: 200 OK\n    Frontend->>Jugador: Mostrar Nuevo Rank #3"
    },
    {
      "type": "flow",
      "title": "Flujo de Decisión de Rate Limiting en Kong",
      "description": "Diagrama de flujo mostrando cómo Kong aplica rate limiting según tipo de usuario y endpoint",
      "location": "api-reference/rate-limits.mdx",
      "mermaid_code": "flowchart TD\n    A[Request Entrante",
      "Limit": 100,
      "IP": "n    B -->|Sí| D{Endpoint<br/>"
    }
  ]
}