{
  "analysis_summary": "La documentación tiene una estructura sólida pero presenta gaps críticos en seguridad, disaster recovery, observabilidad avanzada y guías de contribución. Falta documentación técnica profunda sobre decisiones de arquitectura, patrones de resiliencia y runbooks operacionales. Se requieren más diagramas de flujo de datos y componentes de infraestructura.",
  "overall_score": 6.8,
  "improvements": [
    {
      "priority": "high",
      "category": "content",
      "title": "Documentación de Seguridad Completa",
      "description": "Falta documentación crítica sobre políticas de seguridad, gestión de secretos, escaneo de vulnerabilidades, políticas de red en Kubernetes, y hardening de servicios. Es fundamental para producción.",
      "files_to_create": [
        "security/overview.mdx",
        "security/secrets-management.mdx",
        "security/network-policies.mdx",
        "security/vulnerability-scanning.mdx",
        "security/incident-response.mdx"
      ],
      "files_to_modify": [
        "architecture.mdx",
        "deployment.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "## Gestión de Secretos\n\n### AWS Secrets Manager\nTodos los secretos sensibles se almacenan en AWS Secrets Manager con rotación automática cada 90 días.\n\n### External Secrets Operator\nSincronización automática de secretos desde AWS a Kubernetes usando External Secrets Operator.\n\n### Políticas de Red\nNetworkPolicies de Kubernetes implementadas para limitar tráfico entre pods solo a lo necesario.",
      "mermaid_diagram": "graph TD\n    A[Secretos en AWS Secrets Manager] --> B[External Secrets Operator]\n    B --> C[Secrets en K8s]\n    C --> D[Pods con Variables de Entorno]\n    E[Vault Alternativo] -.-> B\n    F[Rotación Automática] --> A",
      "rationale": "La seguridad es crítica en producción y actualmente no hay documentación sobre cómo se manejan secretos, certificados, políticas de red ni respuesta a incidentes. Esto es un riesgo operacional."
    },
    {
      "priority": "high",
      "category": "content",
      "title": "Disaster Recovery y Backup",
      "description": "No existe documentación sobre estrategias de backup, recuperación ante desastres, RPO/RTO, procedimientos de restauración de bases de datos ni planes de contingencia.",
      "files_to_create": [
        "operations/disaster-recovery.mdx",
        "operations/backup-strategy.mdx",
        "operations/rpo-rto.mdx"
      ],
      "files_to_modify": [
        "infrastructure/overview.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "## Estrategia de Backup\n\n### Base de Datos PostgreSQL\n- Backups automáticos diarios en RDS con retención de 30 días\n- Snapshots manuales antes de cambios mayores\n- Réplicas de lectura en múltiples AZs\n\n### Objetivos\n- RPO: 1 hora (máxima pérdida de datos)\n- RTO: 4 horas (tiempo de recuperación)\n\n### Procedimientos de Restauración\n1. Identificar backup válido\n2. Restaurar RDS desde snapshot\n3. Actualizar endpoints en servicios\n4. Validar integridad de datos",
      "mermaid_diagram": "",
      "rationale": "Sin documentación de DR, el equipo no sabe cómo actuar ante fallos catastróficos. Los RPO/RTO deben estar claramente definidos y los procedimientos de recuperación documentados y probados."
    },
    {
      "priority": "high",
      "category": "diagrams",
      "title": "Diagrama de Flujo de Datos Completo",
      "description": "Falta un diagrama que muestre el flujo completo de datos desde el usuario hasta la persistencia, incluyendo todos los componentes intermedios (CloudFront, ALB, Kong, servicios, bases de datos, caché).",
      "files_to_create": [],
      "files_to_modify": [
        "architecture.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "",
      "mermaid_diagram": "graph LR\n    A[Usuario] --> B[CloudFront CDN]\n    B --> C[Route53 DNS]\n    C --> D[ALB + SSL/TLS]\n    D --> E[Kong API Gateway]\n    E --> F{Tipo de Petición}\n    F -->|Autenticación| G[Auth Service]\n    F -->|Juegos| H[Game Catalog Service]\n    F -->|Puntuaciones| I[Score Service]\n    F -->|Rankings| J[Ranking Service]\n    F -->|Usuarios| K[User Service]\n    G --> L[(PostgreSQL RDS)]\n    H --> L\n    I --> L\n    J --> L\n    K --> L\n    G --> M[(Redis Cache)]\n    I --> M\n    J --> M\n    H --> N[S3 Bucket - Archivos .jsdos]\n    B -.Caché Estática.-> N",
      "rationale": "El diagrama de arquitectura actual es de alto nivel. Se necesita uno detallado que muestre exactamente cómo fluyen las peticiones y datos a través de todos los componentes para debugging y onboarding."
    },
    {
      "priority": "high",
      "category": "content",
      "title": "Documentación de Observabilidad Avanzada",
      "description": "La sección de monitoring es básica. Falta documentación sobre logs centralizados, trazabilidad distribuida, alertas específicas, dashboards, SLIs/SLOs y prácticas de observabilidad.",
      "files_to_create": [
        "operations/observability.mdx",
        "operations/logging.mdx",
        "operations/tracing.mdx",
        "operations/alerting.mdx",
        "operations/slos.mdx"
      ],
      "files_to_modify": [
        "infrastructure/monitoring.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "## Observabilidad en Retro Game Hub\n\n### Stack de Observabilidad\n- **Métricas**: Prometheus + Grafana\n- **Logs**: Loki + Promtail\n- **Trazas**: Jaeger o Tempo\n- **Alertas**: AlertManager\n\n### SLIs Definidos\n- Disponibilidad de API: 99.9%\n- Latencia p95 < 200ms\n- Tasa de error < 0.1%\n\n### Logs Estructurados\nTodos los servicios emiten logs en formato JSON con campos estándar: timestamp, level, service, trace_id, user_id, message.",
      "mermaid_diagram": "graph TD\n    A[Servicios en K8s] --> B[Promtail]\n    A --> C[Prometheus]\n    A --> D[Jaeger Agent]\n    B --> E[Loki]\n    C --> F[Grafana]\n    E --> F\n    D --> G[Jaeger Collector]\n    G --> H[Grafana Tempo]\n    H --> F\n    C --> I[AlertManager]\n    I --> J[PagerDuty/Slack]",
      "rationale": "La observabilidad actual es limitada. Para operar en producción se necesita trazabilidad completa, logs centralizados, alertas proactivas y SLOs definidos. Esto reduce MTTR dramáticamente."
    },
    {
      "priority": "medium",
      "category": "content",
      "title": "Runbooks Operacionales",
      "description": "Faltan runbooks detallados para operaciones comunes: escalar servicios, rotar secretos, actualizar bases de datos, gestionar incidentes, rollback de despliegues.",
      "files_to_create": [
        "operations/runbooks/scaling.mdx",
        "operations/runbooks/secret-rotation.mdx",
        "operations/runbooks/database-maintenance.mdx",
        "operations/runbooks/rollback.mdx",
        "operations/runbooks/index.mdx"
      ],
      "files_to_modify": [
        "troubleshooting.mdx"
      ],
      "files_to_delete": [],
      "proposed_content": "## Runbook: Escalado de Servicios\n\n### Cuándo Escalar\n- CPU > 70% durante 10 minutos\n- Latencia p95 > 500ms\n- Cola de peticiones > 1000\n\n### Procedimiento"
    }
  ]
}